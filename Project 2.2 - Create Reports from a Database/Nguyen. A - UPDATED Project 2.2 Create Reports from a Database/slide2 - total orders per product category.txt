SELECT COUNT (category_name) category_count, category_name
FROM (
	SELECT cat.CategoryName category_name, o.ShipCountry ship_country, o.OrderID
	FROM Categories cat
	JOIN Products p
	ON cat.categoryID = p.categoryID
	JOIN OrderDetails od
	ON p.productID = od.productID
	JOIN Orders o
	ON od.orderID = o.orderID
	JOIN Customers c
	ON o.customerID = c.customerID
	GROUP BY 3
	ORDER BY 1
)
GROUP BY 2
ORDER BY 1 DESC;