SELECT category_name, ROUND(SUM (unit_price * quantity),0) gross_product_sales
FROM (
	SELECT p.productname product_name, p.unitprice unit_price, 	cat.categoryname category_name, od.orderid, od.quantity
	FROM Categories cat
	JOIN Products p
	ON cat.categoryID = p.categoryID
	JOIN OrderDetails od
	ON p.productID = od.productID
	JOIN Orders o
	ON od.orderID = o.orderID
	JOIN Customers c
	ON o.customerID = c.customerID
	GROUP BY 1,4
	ORDER BY 5 DESC
)
GROUP BY 1
ORDER BY 2 DESC;
